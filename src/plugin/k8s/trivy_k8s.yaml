name: trivy_cluster_scan
provider: trivy
variables: 
- name: namespace
  default: "kube-system"
  description: namespace of cluster
command: "k8s -n {{namespace}} --report summary all --kubeconfig binary/kubeconfig.yaml --format json --timeout 15m"
output: 
  data: Findings
  identifier: Results[0].Misconfigurations[0].ID
  title: Results[0].Misconfigurations[0].Title
  severity: Results[0].Misconfigurations[0].Severity
  source: "trivy"
  status: Results[0].Misconfigurations[0].Status
  report: Results[0].MisconfSummary
dependency:
  name: trivy
  version: "0.48.3"
  url: https://storage.googleapis.com/zerone-uploads/binaries/trivy-v0.48.3