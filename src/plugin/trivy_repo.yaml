name: trivy_repo_scan
provider: trivy
variables: 
- name: repo
  default: "repo_path"
  description: path of the repo
- name: github_token
  default: "github_token"
  description: github_token of the repo
- name: gitlab_token
  default: "gitlab_token"
  description: github_token of the repo
command: "export GITHUB_TOKEN={{github_token}} && export GITLAB_TOKEN={{gitlab_token}} && trivy repo --no-progress {{repo}} --format json --timeout 15m" 
output: 
  data: Results[0].Vulnerabilities
  identifier: VulnerabilityID
  createdAt: PublishedDate
  updatedAt: LastModifiedDate
  title: VulnerabilityID
  severity: Severity
  fixed_version: FixedVersion
  package: PkgID
  references: References
  installed_version: InstalledVersion
  description: Description
  source: "trivy"
  status: Status
dependency:
  name: trivy
  version: "0.48.3"
  script: "apt-get update -y && apt-get install -y  wget && wget https://storage.googleapis.com/zerone-uploads/binaries/trivy-v0.48.3 -O /usr/local/bin/trivy && chmod +x /usr/local/bin/trivy"