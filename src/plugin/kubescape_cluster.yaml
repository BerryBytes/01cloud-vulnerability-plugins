name: kubescape_cluster_scan
provider: kubescape
variables:
  - name: k8s_kubeconfig
    default: "/tmp/k8s_kubeconfig.yaml"
    description: kubeconfig of cluster
command: "echo {{k8s_kubeconfig}} | base64 --decode > /tmp/k8s_kubeconfig.yaml && kubescape scan --kubeconfig /tmp/k8s_kubeconfig.yaml framework nsa --format json"
dependency:
  name: kubescape
  version: "0.48.3"
  script: "apt-get update -y && apt-get install -y wget jq && wget https://supreme-test.s3.amazonaws.com/security/kubescape -O /usr/local/bin/kubescape && chmod +x /usr/local/bin/kubescape"
